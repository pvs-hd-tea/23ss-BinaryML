
## 1. Malware Detection Model (HRR Transformers)

### 1.1 Research paper

Recasting Self-Attention with Holographic Reduced Representations: https://arxiv.org/pdf/2305.19534.pdf

### 1.2 Datasets

For original malware detection model: 

```PE Malware Machine Learning Dataset:``` https://practicalsecurityanalytics.com/pe-malware-machine-learning-dataset/

For cross-domain vulnerability detection model: 

```Juliet C/C++ 1.3 test suite by NIST Software Assurance Reference Dataset (SARD):``` https://drive.google.com/file/d/17p2ZntEqE-fwUUPUtb7RtGukJH5zQrs6/view?usp=sharing

### 1.3 Requirements

To run the code in this repository, you need to can install the key dependencies using below commands:

```
pip install --upgrade https://storage.googleapis.com/jax-releases/cuda11/jaxlib-0.3.15+cuda11.cudnn82-cp39-none-manylinux2014_x86_64.whl
pip install flax==0.6.0
pip install optax==0.1.2
```
```
pip install tensorflow-cpu==2.8.0
pip install tensorflow-datasets==4.5.2
pip install torch torchvision torchaudio --extra-index-url https://download.pytorch.org/whl/cpu
```
Finally, the library that implements the vector symbolic architecture called Holographic Reduced Representations (HRR) which is the key concept used to develop Hrr Transformer.
```
pip install hrr --upgrade
```
You can install the other minors dependencies in requirements.txt using the following command:

```
pip install -r requirements.txt
```

### 1.4 Getting Started

**Preliminaries**
1. Clone the repository: ```git clone https://github.com/pvs-hd-tea/23ss-BinaryML.git```
2. Install the required dependencies.
3. Download the datasets from the mentioned links and split into Train, Test and Validation sets manually. Note that the cross-domain vulnerability dataset has already been split. 
   1. Update all the dataset paths in ```initialization.py``` accordingly.
4. Note that the saved models for both malware and vulnerability domains are present in corresponding sub folders in ```weights``` folder. Naming format for saved models is ```hrrformer_multi_1_<max_seq_len>.h5```

**Execution** 

1. <ins>For Data Loading</ins>:

    ```dataset.py``` class is used to load and visualize the datasets. Can be executed using the following command:
        
        python dataset.py <malware/vulnerability> <train/test/predict>
    Replace <malware/vulnerability> with either "malware" or "vulnerability" and <train/test/predict> with one of "train," "test," or "predict," depending on the operation you want to perform.


2. <ins>For Training, Testing & evaluating</ins>:

    Run the ```hrrformer_mgpu.py``` script to train, test and evaluate the model using the following command:
   
        python hrrformer_mgpu.py <malware/vulnerability> <train/test/predict>

Note on program arguments:

```malware```: For original malware detection model.

```vulnerability```: For cross domain vulnerability detection model.

Data for corresponding domain will be loaded based on this argument.

```train```: To initiate the training process of the selected domain (malware/vulnerability) and save the model in respective ```weights``` folder.

```test```: To evaluate trained model's performance using a testing dataset.

```predict```: To make individual predictions using the saved trained model. For predictions, place your input data in corresponding domain's Test dataset paths.

For ```test``` and ```predict```, make sure that the saved model file of corresponding domain exists in ```/weights``` folder. 