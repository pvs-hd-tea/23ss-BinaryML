# ROMEO: Exploring Juliet through the Lens of Assembly Language

## What is it?
The ROMEO dataset serves as a machine code counterpart to Juliet, to verify vulnerability detection methods that operate on binary or assembly representations. We also offer an assembly language representation in this repository. Our focus is on the x86-64 ISA.

### Juliet?
The Juliet Test Suite for C/C++ 1.3 ([Juliet](https://samate.nist.gov/SRD/around.php#juliet_documents)) is a part of the Software Assurance Reference Database ([SARD](https://samate.nist.gov/SRD/index.php)) contributed by the NSA Center for Assured Software. It consists of 64,099 test cases covering 118 different Common Weakness Enumerations (CWEs) in a variety of situations.


## Raw Data
The binaries are provided as 66,147 object files in ELF format as well as linked-together files as specified in the paper. They are compiled using GCC 11.2.0 targeting x86_64-pc-linux-gnu. You can find them in the `object_files` directory. Alternatively, you can build your own by downloading Juliet 1.3 and executing `create_per_cwe_files.py` and then `make`.

## Before you Begin to run the code please follow the following steps.

## Vulnarability detection data:

Please create the following folder:
'object_files' and download the following dataset
https://gitlab.com/dlr-dw/romeo/-/tree/main/object_files?ref_type=heads
no need to extract, just place the tar.gz file into the folder

## Malware detection data:

Download and extract the following link into the base folder VulnarabilityDetectionRomeo
https://drive.google.com/file/d/1-FW6Ky5rdipwMnIk9wL7jH2cCx4z6YkM/view?usp=drive_link
There should be a folder named malware_binaries

## To rerun any code from checkpoints from our previous runs:

Place the files from any of the subfolders of logs into the intermediate/run-fulldataset folder
Then download the corresponding classifier folder from this link 
https://drive.google.com/drive/folders/104Yyhwa7QkCVW9Jy-X2L124QdFmV0hf6?usp=drive_link
place the classifier folder and it's contents into intermediate/run-fulldataset

The classifier folder consists of our trained models

## Reproducing the Results
In the `pipelines` folder, we supply configurations to build the full dataset as well as the no-context variant. For example, to build the full ROMEO, change to the `python` directory and execute:
```bash
python -m run_pipeline ../pipelines/fulldataset.yaml fulldataset
```

This pipeline requires you to set the `JULIET_BASE_DIR` environment variable to the location of the `C` folder of the Juliet suite if you wish to use your own distribution.
If you do not set this variable, it will extract the included object files to `~/.local/share/romeo` automatically.
It will also train and evaluate a Transformer-based model after the dataset has been created. You can find the results in the `intermediate` directory.

## **<ins>For 1-click demo<ins>:**

Executing might take a few hours, but if you simply wish to verify whether everything works, you can append `--smoke-test` to the command line for a fast run-through of the pipeline.

## Cross Domain Detection
Malware Dataset used for Cross Domain detection:([Malware Dataset]([https://samate.nist.gov/SRD/around.php#juliet_documents](https://drive.google.com/file/d/1-FW6Ky5rdipwMnIk9wL7jH2cCx4z6YkM/view))) 
Set the ‘MALWARE_BASE_DIR’ environment variable to the location of the ‘object_files’ folder of the Malware dataset.

## Producing Cross Domain Results 
To run cross domain detection on malware dataset include the --malware flag.
```bash
python -m run_pipeline ../pipelines/fulldataset.yaml fulldataset --malware
```

### Prerequisites
ROMEO requires the packages specified in `requirements.txt` along with Python 3.9. In addition, a current version of GNU binutils is required to disassemble the object files. For our paper, we used `objdump` version `2.27-44`. If you wish to train the Transformer model, a GPU is highly recommended.
